<script src="js/plugins/bsnAutoSuggest/bsn.AutoSuggest_2.1.3_comp.js"></script>
<link href="css/bsnAutoSuggest/autosuggest_inquisitor.css" rel="stylesheet" type="text/css" />
<form role="form" method="post" action="admin_pessoa-action" id="frmEditPessoa" enctype="multipart/form-data" autocomplete="off">
    <div class="box box-primary">
        <div class="box-header">
            <h3 class="box-title">{LABEL}</h3>
        </div>
        <div class="box-body">

            <input type="hidden" name="id" id="id" value="{id}"/>             
            <input type="hidden" name="acao" value="{ACAO}"/>
           
           <fieldset>
                <legend>Documentos</legend>
                <div class="row">   
                 <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="cpf"><i class='fa'> </i><b>CPF </b>&nbsp;&nbsp;&nbsp;&nbsp; <input type="checkbox" class="form-control flat-blue" name="semcpf" id="semcpf" {SEMCPFCHECKED}/> Sem CPF</label>
                        <input type="text" id="cpf" name="cpf" value="{CPF}" class="form-control cpfcnpj"/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="rg"><i class='fa'> </i><b>RG</b>&nbsp;&nbsp;&nbsp;&nbsp; <input type="checkbox" class="form-control flat-blue" name="semrg" id="semrg" {SEMRGCHECKED}/> Sem RG</label>
                        <input type="text" id="rg" name="rg" value="{RG}" class="form-control"/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="rgOrgaoExpedidor"><i class='fa'> </i><b>Orgão Espedidor</b></label>
                        <input type="text" id="rgOrgaoExpedidor" name="rgOrgaoExpedidor" value="{RG_ORGAO_EXP}" class="required form-control"/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="rgDataExp"><i class='fa'> </i><b>Data Expedição</b></label>
                        <input type="text" id="rgDataExp" name="rgDataExp" value="{RG_DATA_EXP}" class="required form-control"/>
                    </div>
                </div>
                </div>
                <div class="row">   
                 <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="passaporte"><i class='fa'> </i><b>Passaporte</b></label>
                        <input type="text" id="passaporte" name="passaporte" value="{PASSAPORTE}" class="form-control"/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="passaporteDataVal"><i class='fa'> </i><b>Data Validade</b></label>
                        <input type="text" id="passaporteDataVal" name="passaporteDataVal" value="{PASSAPORTE_VAL}" class="form-control "/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="passaporteOrgao"><i class='fa'> </i><b>Orgão Espedidor</b></label>
                        <input type="text" id="passaporteOrgao" name="passaporteOrgao" value="{PASSAPORTE_ORGAO_EXP}" class="form-control "/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="passaporteDataExp"><i class='fa'> </i><b>Data Expedição</b></label>
                        <input type="text" id="passaporteDataExp" name="passaporteDataExp" value="{PASSAPORTE_DATA_EXP}" class="form-control"/>
                    </div>
                </div>
                </div>
            </fieldset>  
           
            <fieldset><legend>Dados Pessoais</legend>
            <div class="row">
                <div class="col-md-4 col-xs-4">
                    <div class="form-group">
                        <label for="nome"><i class='fa'> </i><b>Nome</b></label>
                        <input type="text" id="nome" name="nome" placeholder="Nome do Pessoa" value="{NOME}" class="required form-control"/>
                    </div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <div class="form-group">
                        <label for="nomeMeio"><i class='fa'> </i><b>Nome do Meio</b></label>
                        <input type="text" id="nomeMeio" name="nomeMeio" placeholder="Nome do meio do Pessoa" value="{NOME_MEIO}" class="form-control"/>
                    </div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <div class="form-group">
                        <label for="sobrenome"><i class='fa'> </i><b>Sobre Nome</b></label>
                        <input type="text" id="sobrenome" name="sobrenome" placeholder="Sobre nome do pessoa" value="{SOBRE_NOME}" class="required form-control"/>
                    </div>
                </div>                 
                
            </div>
            <div class="row">
            	<div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="nacionalidade"><i class='fa'> </i><b>Nome do Pai</b></label>
                        <input type="text" id="filiacaoPai" name="filiacaoPai" placeholder="Nome do pai do pessoa" value="{FILIACAO_PAI}" class="form-control"/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="nacionalidade"><i class='fa'> </i><b>Nacionalidade</b></label>
                        <input type="text" id="nacionalidade" name="nacionalidade" placeholder="País de nascimento do Pessoa" value="{NACIONALIDADE}" class="required form-control"/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                     <label for="ufnaturalidade"><i class='fa'> </i><b>UF Naturalidade</b></label><br/>   
                      <select name="ufnaturalidade" id="ufnaturalidade" class="required form-control">
                            <option value="">Selecione</option>
                            <!-- BEGIN BLOCK_UF_NATURALIDADE -->
                            <option value="{id_uf}" {selectedUf_nat}>{uf}</option>
                            <!-- END BLOCK_UF_NATURALIDADE -->
                        </select>  
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="naturalidade"><i class='fa'> </i><b>Naturalidade </b></label>
                        <select name="naturalidade" id="naturalidade" class="required form-control">
                            <option value="">Selecione</option>
                            <!-- BEGIN BLOCK_CIDADE_NATURALIDADE -->
                            <option value="{id_cidade_nat}" {selectedCidadeNaturalidade}>{nome_cidade_nat}</option>
                            <!-- END BLOCK_CIDADE_NATURALIDADE -->
                        </select>
                    </div>
                </div>
            </div>
            <div class="row">
            	<div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="nacionalidade"><i class='fa'> </i><b>Nome da Mãe</b></label>
                        <input type="text" id="filiacaoMae" name="filiacaoMae" placeholder="Nome da mãe do pessoa" value="{FILIACAO_MAE}" class="form-control"/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="email"><i class='fa'> </i><b>E-mail</b></label>
                        <input type="text" id="email" name="email" placeholder="E-mail do Pessoa" value="{EMAIL}" class="email required form-control"/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="dataNascimento"><i class='fa'> </i><b>Data de Nascimento</b></label>
                        <input type="text" id="dataNascimento" name="dataNascimento" value="{DATA_NASCIMENTO}" class="required form-control"/>
                    </div>
                </div>
                <div class="col-md-3 col-xs-3">
                    <div class="form-group">
                        <label for="sexo"><i class='fa'> </i><b>Sexo</b></label><br/>
                        <select class="form-control required" name="sexo">
                            <option value="" required>Selecione</option>
                            <option value="F" {SELECTED_FEMININO}>Feminino</option>
                            <option value="M" {SELECTED_MASCULINO}>Masculino</option>
                        </select>
                    </div>
                </div>
            </div>            
            <div class="row">
                <div class="col-md-4 col-xs-4">
                    <div class="form-group">
                        <label for="telefoneRes"><i class='fa'> </i><b>Telefone 1</b></label>
                        <input type="text" id="telefoneRes" name="telefoneRes" value="{TELEFONE_RES}" class="required form-control"/>
                    </div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <div class="form-group">
                        <label for="telefoneCel"><i class='fa'> </i><b>Telefone 2</b></label>
                        <input type="text" id="telefoneCel" name="telefoneCel" value="{TELEFONE_CEL}" class="form-control"/>
                    </div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <div class="form-group">
                        <label for="telefoneCom"><i class='fa'> </i><b>Telefone 3</b></label>
                        <input type="text" id="telefoneCom" name="telefoneCom" value="{TELEFONE_COM}" class="form-control"/>
                    </div>
                </div>
            </div>
            <div class="row">                
                <div class="col-md-6 col-xs-6">
                     <div class="form-group">
                        <label for="webSite"><i class='fa'> </i><b>Web Site</b></label><BR>
                        <input type="text" id="webSite" name="webSite" value="{WEB_SITE}" class="form-control"/>
                    </div>
                </div>  
                <div class="col-md-6 col-xs-6">
                     <div class="form-group">
                        <label for="midiaSocial"><i class='fa'> </i><b>Mídia Social</b></label><BR>
                        <input type="text" id="midiaSocial" name="midiaSocial" value="{MIDIA_SOCIAL}" class="form-control"/>
                    </div>
                </div>              
            </div>
            <div class="row">                
                <div class="col-md-6 col-xs-6">
                     <div class="form-group">
                        <label for="Foto"><i class='fa'> </i><b>Foto</b></label><BR>
                        <input type="file"  name="foto" id="foto"/>
                    </div>
                </div>  
                <div class="col-md-6 col-xs-6">
                     <div class="form-group">
                        <label for="vacinas"><i class='fa'> </i><b>Vacinas</b></label><BR>
                        <textarea class="form-control" name="vacinas" id='vacinas' rows="7">{VACINAS}</textarea>
                    </div>
                </div>              
            </div>  
            </fieldset>
              
            <fieldset><legend>Endereço</legend>
                <div class="row">
                <div class="col-md-6 col-xs-6">
                    <div class="form-group">
                        <label for="endereco"><i class='fa'> </i><b>Logradouro</b></label>
                        <input type="text" id="endereco" name="endereco" value="{ENDERECO}" class="required form-control"/>
                    </div>
                </div>
                <div class="col-md-6 col-xs-6">
                    <div class="form-group">
                        <label for="bairro"><i class='fa'> </i><b>Bairro</b></label>
                        <input type="text" id="bairro" name="bairro" value="{BAIRRO}" class="required form-control"/>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-2 col-xs-2">
                    <div class="form-group">
                        <label for="uf"><i class='fa'> </i><b>Estado</b></label>
                         <select name="uf" id="uf" class="required form-control">
                            <option value="">Selecione</option>
                            <!-- BEGIN BLOCK_UF -->
                            <option value="{id_uf}" {selectedUf}>{uf}</option>
                            <!-- END BLOCK_UF -->
                        </select>
                    </div>
                </div>
                <div class="col-md-6 col-xs-6">
                    <div class="form-group">
                        <label for="cidade"><i class='fa'> </i><b>Cidade</b></label>
                        <select name="cidade" id="cidade" class="required form-control">
                            <option value="">Selecione</option>
                            <!-- BEGIN BLOCK_CIDADE -->
                            <option value="{id_cidade}" {selectedCidade}>{nome_cidade}</option>
                            <!-- END BLOCK_CIDADE -->
                        </select>
                    </div>
                </div>
                <div class="col-md-4 col-xs-4">
                    <div class="form-group">
                        <label for="cep"><i class='fa'> </i><b>CEP</b></label>
                        <input type="text" id="cep" name="cep" value="{CEP}" class="required form-control"/>
                    </div>
                </div>
            </div>
            </fieldset>
            
        <div class="box-footer text-center">
            <button class="btn btn-success" id="save" type="button">
                Salvar
            </button>
            <button class="btn btn-default btVoltar" type="button">
                Cancelar
            </button>
        </div>

    </div>
</div>
</form>
<script>

    function cidadePorUf(){
         $.ajax({
                url : "ajax/cidadesPorUf.php",
                type : "POST",
                async:false,
                data : {uf: $("#uf").val()},                
            }).done(function(msg) {
                $("#cidade").html(msg);
            });
    }
	$(document).ready(function() {
	    
	    
	    
	    $("#save").click(function(){
            
            if($("#frmEditPessoa").valid()){
            $.ajax({
                url : "ajax/pessoa_consultaNomesPessoa.php",
                type : "POST",
                data : {nome: $("#nome").val(),nomeMeio:$("#nomeMeio").val(),sobrenome:$("#sobrenome").val()},                
            }).done(function(msg) {
                 if(msg == "1"){
                if(confirm("Já existe uma pessoa com o mesmo nome, nome do meio e sobrenome no sistema, desenja confirmar o cadastro?"))
                    $("#frmEditPessoa").submit();
            }else{
                $("#frmEditPessoa").submit();
            }
                
                
            });
            
           
            }
        });
	    
	    
	    $('#dataNascimento').datepicker();
        $('#dataFiliacao').datepicker();
        $("#dataGraduacao").datepicker();
        $('#dataEmissaoCarteira').datepicker();
        $('#rgDataExp').datepicker();
        $('#passaporteDataVal').datepicker();
        $('#passaporteDataExp').datepicker();
        
        $("#cpf").inputmask({ mask: ["999.999.999-99","99.999.999/9999-99"] });
        $("#telefoneRes").inputmask({ mask: ["+99 99 9999-9999","+99 99 99999-9999"]});
        $("#telefoneCel").inputmask({ mask: ["+99 99 9999-9999","+99 99 99999-9999"]});
        $("#telefoneCom").inputmask({ mask: ["+99 99 9999-9999","+99 99 99999-9999"]});
        $("#cep").inputmask({ mask: "99.999-999"});
        
        $("#frmEditPessoa").validate({
            errorClass : "help-inline",
            errorElement : "div",
            highlight : function(element, errorClass, validClass) {
                $(element).parents('.form-group').addClass('has-error');
                $(element).parents('.form-group').children("label").children("i").addClass("fa-times-circle-o");
            },
            unhighlight : function(element, errorClass, validClass) {
                $(element).parents('.form-group').removeClass('has-error');
                $(element).parents('.form-group').addClass('has-success');
                $(element).parents('.form-group').children("label").children("i").removeClass("fa-times-circle-o");
                $(element).parents('.form-group').children("label").children("i").addClass("fa-check");
            },
            
            rules : {
                cpf :{
                    required:{
                         depends: function () { return !$("#semcpf").prop("checked"); }
                    },
                    remote: {
                            url: "ajax/pessoa_verificaCpf.php",
                            type: "post",
                            data: {
                              idUser: function() {
                                return $("#id").val();
                              }
                            }
                            } 
                },
                rg :{
                    required:{
                         depends: function () { return !$("#semrg").prop("checked"); }
                    } 
                },
                rgOrgaoExpedidor :{
                    required:{
                         depends: function () { return !$("#semrg").prop("checked"); }
                    } 
                },
                rgDataExp :{
                    required:{
                         depends: function () { return !$("#semrg").prop("checked"); }
                    } 
                },
                email: {
                required: true,
                remote: {
                            url: "ajax/usuario_verificaLogin.php",
                            type: "post",
                            data: {
                              idUser: function() {
                                return $("#id").val();
                              }
                            }
                            }
                }
                },
                messages: {
                    email: {
                    remote: "E-mail já existe no sistema"
                    },
                    cpf: {
                        remote: "CPF já existe no sistema"
                    }
                }
                
        });
        
        
        
    
    $("#foto").fileinput({
        initialPreview: [
        <!-- BEGIN BLOCK_FOTO -->"{FOTO}",<!-- END BLOCK_FOTO -->
        ], overwriteInitial: true,
        maxFileSize: 2000,
        maxFilesNum: 1,
        allowedFileExtensions: ["jpg", "jpeg", "gif", "png"],
        previewClass: "bg-warning",
        allowedFileTypes: ["image"],
        showUpload: false,
        showCaption: false,
        showRemove: false,
        language: 'pt-BR'
    });
    
   
    $("#uf").change(function(){
            $.ajax({
                url : "ajax/cidadesPorUf.php",
                type : "POST",
                data : {uf: $(this).val()},                
            }).done(function(msg) {
                $("#cidade").html(msg);
            });

        });
        $("#ufnaturalidade").change(function(){
            $.ajax({
                url : "ajax/cidadesPorUf.php",
                type : "POST",
                data : {uf: $(this).val()},                
            }).done(function(msg) {
                $("#naturalidade").html(msg);
            });

        });
        
       
	});
</script>
